<div class="container justify-content-center w-100">
  <%= form_for camp, url: camps_path, html: { multipart: true } do |form| %>
  <% if camp.errors.any? %>
    <% flash[:alert] = camp.errors.full_messages %>
  <% end %>

  <!-- Name -->
  <div class="center input-group mb-3 ">
    <span class="input-group-text">
      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-alphabet" viewBox="0 0 16 16">
        <path d="M2.204 11.078c.767 0 1.201-.356 1.406-.737h.059V11h1.216V7.519c0-1.314-.947-1.783-2.11-1.783C1.355 5.736.75 6.42.69 7.27h1.216c.064-.323.313-.552.84-.552s.864.249.864.771v.464H2.346C1.145 7.953.5 8.568.5 9.496c0 .977.693 1.582 1.704 1.582m.42-.947c-.44 0-.845-.235-.845-.718 0-.395.269-.684.84-.684h.991v.538c0 .503-.444.864-.986.864m5.593.937c1.216 0 1.948-.869 1.948-2.31v-.702c0-1.44-.727-2.305-1.929-2.305-.742 0-1.328.347-1.499.889h-.063V3.983h-1.29V11h1.27v-.791h.064c.21.532.776.86 1.499.86Zm-.43-1.025c-.66 0-1.113-.518-1.113-1.28V8.12c0-.825.42-1.343 1.098-1.343.684 0 1.075.518 1.075 1.416v.45c0 .888-.386 1.401-1.06 1.401Zm2.834-1.328c0 1.47.87 2.378 2.305 2.378 1.416 0 2.139-.777 2.158-1.763h-1.186c-.06.425-.313.732-.933.732-.66 0-1.05-.512-1.05-1.352v-.625c0-.81.371-1.328 1.045-1.328.635 0 .879.425.918.776h1.187c-.02-.986-.787-1.806-2.14-1.806-1.41 0-2.304.918-2.304 2.338z"/>
      </svg>
    </span>
    <div class="form-floating">
      <input name="camp[name]"
             id="camp_name"
             placeholder="Name"
             value="<%= @camp.name if present? %>"
             type="text"
             required
             aria-label="name"
             class="form-control">

      <label for="camp_name">Name</label>
    </div>
  </div>

  <!-- General Description -->
  <div class="center mb-3">
    <%= form.label "Generelle Lagerbeschreibung" %>
    <%= form.rich_text_area :this_camp_description %>
  </div>


  <!-- Template -->
  <div class="center input-group mb-3">
      <span class="input-group-text">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-ladder" viewBox="0 0 16 16">
          <path d="M4.5 1a.5.5 0 0 1 .5.5V2h6v-.5a.5.5 0 0 1 1 0v14a.5.5 0 0 1-1 0V15H5v.5a.5.5 0 0 1-1 0v-14a.5.5 0 0 1 .5-.5M5 14h6v-2H5zm0-3h6V9H5zm0-3h6V6H5zm0-3h6V3H5z"/>
        </svg>
      </span>
    <div class="form-floating">
      <select name="camp[template]" id="camp_template" class="form-select" aria-label="leader select">
        <% ["Kein Lager ausgeschrieben", "Lager ausgeschrieben"].each do |template_option| %>
          <option value="<%= template_option %>" <%= 'selected' if @camp.template == template_option %>>
            <%= template_option %>
          </option>
        <% end %>
      </select>
      <label for="camp_template">Vorlage w채hlen</label>
    </div>
  </div>

    <!-- HLL -->
  <div class="center input-group mb-5">
  <span class="input-group-text">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-ladder" viewBox="0 0 16 16">
      <path d="M4.5 1a.5.5 0 0 1 .5.5V2h6v-.5a.5.5 0 0 1 1 0v14a.5.5 0 0 1-1 0V15H5v.5a.5.5 0 0 1-1 0v-14a.5.5 0 0 1 .5-.5M5 14h6v-2H5zm0-3h6V9H5zm0-3h6V6H5zm0-3h6V3H5z"/>
    </svg>
  </span>
    <div class="form-floating">
      <select name="camp[leader_id]" id="camp_leader_id" class="form-select" aria-label="leader select">
          <% @all_leaders.each do |leader_option| %>
            <option value="<%= leader_option.id %>">
              <%= leader_option.pfadiname %>
            </option>
          <% end %>
      </select>
      <label for="camp_leader_id">Hauptlagerleiter w채hlen</label>
    </div>
  </div>


  <!-- Diesj채hrige Lagerbeschreibung -->
  <div class="center mb-3 mt-3">
    <%= form.label "Diesj채hrige Lagerbeschreibung" %>
    <%= form.rich_text_area :this_camp_description %>
  </div>


  <!-- Images -->
    <% if camp.images.attached? %>
      <% camp.images.each do |image| %>
        <% if image.id.present? %>
          <div class="attachment-wrapper center">
            <%= image_tag image, height: 100, width: 100 %>
            <%= form.hidden_field :images, multiple: true, value: image.signed_id, id: "image-#{image.id}" %>
          </div>
        <% end %>
      <% end %>
    <% end %>

  <!-- File input for adding new attachments -->
  <div class="center">
    <%= form.file_field :images, multiple: true, id: "new-attachments" %>
  </div>

  <div class="text-center" style="margin-top: 50px">
    <%= form.submit class: "btn btn-custom-warning" %>
  </div>
<% end %>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Select all the remove buttons
        document.querySelectorAll('.remove-attachment').forEach(function (button) {
            button.addEventListener('click', function () {
                const attachmentId = this.getAttribute('data-id');

                // Find the hidden field corresponding to the attachment and remove it
                const hiddenField = document.getElementById(`image-${attachmentId}`);
                if (hiddenField) {
                    hiddenField.remove();
                }

                // Optionally, remove the preview of the attachment (if displayed)
                this.closest('.attachment-wrapper').remove();
            });
        });
    });
</script>
